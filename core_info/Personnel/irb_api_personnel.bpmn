<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_06pyjz2" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.5.0">
  <bpmn:process id="UserTask_ShowInvalidUIDs" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_0kcrx5l</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:scriptTask id="ScriptTask_LoadPersonnel" name="Load IRB Personnel">
      <bpmn:incoming>Flow_00zanzw</bpmn:incoming>
      <bpmn:incoming>Flow_0kcrx5l</bpmn:incoming>
      <bpmn:outgoing>Flow_1dcsioh</bpmn:outgoing>
      <bpmn:script># Clear Datastores
if study_data_get("sdsPI_ComputingID",'') != '':
	study_data_set("sdsPI_ComputingID",'')
if study_data_get("sdsDC_ComputingID",'') != '':
	study_data_set("sdsDC_ComputingID",'')
# Clear list of associates
# if len(get_study_associates()) &gt; 1:
update_study_associates()
asscs = get_study_associates()
newPI = False
curPI = ''
newDC = False
curDC = ''
for assc in asscs:
	if assc['role'] == "Primary Investigator":
		 curPI = assc['uid']
	if assc['role'] == "Department Chair":
		 curDC = assc['uid']
del(assc)

# Load IRB Personnel
investigators = study_info('investigators')
E0_pass_cnt = 1

# Primary Investigator
pi = investigators.get('PI', None)
is_cu_pi = False
if pi != None:
	hasPI = True
	study_data_set("sdsPiUid",pi['uid'])
	if pi.get('uid', None) != None:
		pi_invalid_uid = False
		pi['E0'] = {}
		if pi['uid'] == current_user['uid']:
			is_cu_pi = True
		if pi['uid'] != curPI:
			newPI = True
	else:
		pi_invalid_uid = True
else:
	hasPI = False
	pi_invalid_uid = True

# Department Chair
dc = investigators.get('DEPT_CH', None)
if dc != None:
	hasDC = True
	if dc.get('uid', None) != None:
		dc_invalid_uid = False
		dc['E0'] = {}
		if dc['uid'] != curDC:
			newDC = True
	else:
		dc_invalid_uid = True
else:
	hasDC = False
	dc_invalid_uid = True


# Primary Coordinators
pcs = {}
pcx = {}
is_cu_pc = False
for k in investigators.keys():
	if k in ['SC_I','SC_II','IRBC']:
		investigator = investigators.get(k)
		if investigator.get('uid', None) != None:
			if investigator['uid'] != current_user['uid']:
				pcs[k] = investigator
			else:
				is_cu_pc = True
				is_cu_pc_role = investigator['label']
		else:
			pcx[k] = investigator
if len(pcx.keys()) &gt; 0:
	pcs_invalid_uid = True
else:
	pcs_invalid_uid = False
if len(pcs.keys()) &gt; 0:
	cnt_pcs = len(pcs.keys())
	del(k)
	del(investigator)
else:
	cnt_pcs = 0

# Sub-Investigatoers
subs = {}
subx = {}
is_cu_subs = False
for k in investigators.keys():
	if k[:2] == 'SI':
		investigator = investigators.get(k)
		if investigator.get('uid', None) != None:
			if investigator['uid'] != current_user['uid']:
				subs[k] = investigator
			else:
				is_cu_subs = True
		else:
			subx[k] = investigator
if len(subx.keys()) &gt; 0:
	subs_invalid_uid = True
else:
	subs_invalid_uid = False
if len(subs.keys()) &gt; 0:
	cnt_subs = len(subs.keys())
	del(k)
	del(investigator)
else:
	cnt_subs = 0

# Additional Personnel
aps = {}
apx = {}
is_cu_ap = False
for k in investigators.keys():
	if k in ['AS_C','DC']:
		investigator = investigators.get(k)
		if investigator.get('uid', None) != None:
			if investigator['uid'] != current_user['uid']:
				aps[k] = investigator
			else:
				is_cu_ap = True
				is_cu_ap_role = investigator['label']
		else:
			apx[k] = investigator
if len(apx.keys()) &gt; 0:
	aps_invalid_uid = True
else:
	aps_invalid_uid = False
if len(aps.keys()) &gt; 0:
	cnt_aps = len(aps.keys())
	del(k)
	del(investigator)
else:
	cnt_aps = 0
		
del(investigators)</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:endEvent id="EndEvent_1qor16n">
      <bpmn:documentation>## **Personnel Summary**

### Principle Investigator
#### **{{ pi.display_name }}**
&amp;emsp;**Email Address:** {{ pi.email_address }}
&amp;emsp;**Full Access to CRConnect:** {% if pi.access %}Yes{%- else -%}No{%- endif %}
&amp;emsp;**Email Notifications:** {% if pi.emails %}Yes{%- else -%}No{% endif %}
&amp;emsp;**Experience:** {{ pi.experience|indent(4) }}


### Department Chair
{% if dc.uid == pi.uid -%}
The Study's Principle Investigator is also the Department Chair
{% else %}
#### **{{ dc.display_name }}**
&amp;emsp;**Email Address:** {{ dc.email_address }}
&amp;emsp;**Full Access to CRConnect:** {% if dc.access %}Yes{%- else -%}No{%- endif %}
&amp;emsp;**Email Notifications:** {% if dc.emails %}Yes{%- else -%}No{% endif %}
{%- endif %}


### Primary Coordinators
{% if cnt_pcs &gt; 0 -%}
{% for k, pc in pcs.items() -%}
#### **{{ pc.display_name }}**
&amp;emsp;**Email Address:** {{ pc.email_address }}
&amp;emsp;**Full Access to CRConnect:** {% if pc.access %}Yes{%- else -%}No{%- endif %}
&amp;emsp;**Email Notifications:** {% if pc.emails %}Yes{%- else -%}No{% endif %}
{% endfor %}
{% else %}
No Study Coordinators entered in Protocol Builder
{% endif %}


### Sub-Investigators
{% if cnt_subs &gt; 0 -%}
{% for k, sub in subs.items() -%}
#### **{{ sub.display_name }}**
&amp;emsp;**Email Address:** {{ sub.email_address }}
&amp;emsp;**Full Access to CRConnect:** {% if sub.access %}Yes{%- else -%}No{%- endif %}
&amp;emsp;**Email Notifications:** {% if sub.emails %}Yes{%- else -%}No{% endif %}
{% endfor %}
{% else %}
No Sub-Investigators entered in Protocol Builder
{% endif %}


### Additional Personnel
{% if cnt_aps &gt; 0 -%}
{% for k, ap in aps.items() -%}
#### **{{ ap.display_name }}**
&amp;emsp;**Email Address:** {{ ap.email_address }}
&amp;emsp;**Full Access to CRConnect:** {% if ap.access %}Yes{%- else -%}No{%- endif %}
&amp;emsp;**Email Notifications:** {% if ap.emails %}Yes{%- else -%}No{% endif %}
{% endfor %}
{% else %}
No Additional Personnel entered in Protocol Builder
{% endif %}


{% if pcs_invalid_uid or subs_invalid_uid or aps_invalid_uid %}
## **Invalid Computing IDs**
{% if pcs_invalid_uid %}
### Primary Coordinators
{% for k, px in pcx.items() %}
{{ px.error }}
{% endfor %}
{% endif %}
{% if subs_invalid_uid %}
### Sub-Investigators
{% for k, sx in subx.items() %}
{{ sx.error }}
{% endfor %}
{% endif %}
{% if aps_invalid_uid %}
### Additional Personnnel
{% for k, ax in aps.items() %}
{{ ax.error }}
{% endfor %}
{% endif %}
{% endif %}</bpmn:documentation>
      <bpmn:incoming>Flow_1ounwjs</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:userTask id="Activity_EditPI" name="Update PI Info" camunda:formKey="PI_Info">
      <bpmn:documentation>##### Please confirm Primary Investigator entered in Protocol Builder is correct and if so, provide additional information:
### **{{ pi.display_name }}** 
***Email:*** {{ pi.email_address }}

{% if is_me_pi %}
Since you are the person entering this information, you already have access and will receive all emails.
{% endif %}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="pi.experience" label="Investigator&#39;s Experience" type="textarea">
            <camunda:properties>
              <camunda:property id="rows" value="5" />
            </camunda:properties>
          </camunda:formField>
          <camunda:formField id="pi.access" label="Should the Principal Investigator have full editing access in the system?" type="boolean" defaultValue="True">
            <camunda:properties>
              <camunda:property id="hide_expression" value="is_cu_pi" />
            </camunda:properties>
          </camunda:formField>
          <camunda:formField id="pi.emails" label="Should the Principal Investigator receive automated email notifications?" type="boolean" defaultValue="True">
            <camunda:properties>
              <camunda:property id="hide_expression" value="is_cu_pi" />
            </camunda:properties>
          </camunda:formField>
        </camunda:formData>
        <camunda:properties>
          <camunda:property name="display_name" value="pi.label" />
        </camunda:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0vu7oqk</bpmn:incoming>
      <bpmn:outgoing>Flow_09rormr</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0kcrx5l" sourceRef="StartEvent_1" targetRef="ScriptTask_LoadPersonnel" />
    <bpmn:sequenceFlow id="Flow_1dcsioh" sourceRef="ScriptTask_LoadPersonnel" targetRef="Gateway_CheckUIDs" />
    <bpmn:exclusiveGateway id="Gateway_0jykh6r" name="How many Primary Coordinators?" default="Flow_0xifvai">
      <bpmn:incoming>Flow_1h7zs6c</bpmn:incoming>
      <bpmn:outgoing>Flow_0xifvai</bpmn:outgoing>
      <bpmn:outgoing>Flow_1oqem42</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0xifvai" name="1 or more" sourceRef="Gateway_0jykh6r" targetRef="TaskPMI_UpdateCoordinatorInfo" />
    <bpmn:userTask id="TaskPMI_UpdateCoordinatorInfo" name="Update Primary Coordinator Info" camunda:formKey="SC_AccessEmails">
      <bpmn:documentation>The following Primary Coordinators were entered in Protocol Builder:
{%+ for key, value in pcs.items() %}{{value.display_name}} ({{key}}){% if loop.index is lt cnt_pcs %}, {% endif %}{% endfor %}
To Save the current settings for all Primary Coordinators, select Save All.


Otherwise, edit each Coordinator as necessary and select the Save button for each.

### Please provide supplemental information for:
 #### {{ pc.display_name }} 
 ##### Title: {{ pc.title }}

 ##### Department: {{ pc.department }}
 ##### Affiliation: {{ pc.affiliation }}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="pc.access" label="Should this Coordinator have full editing access in the system?" type="boolean" defaultValue="true" />
          <camunda:formField id="pc.emails" label="Should this Coordinator receive automated email notifications?" type="boolean" defaultValue="true" />
        </camunda:formData>
        <camunda:properties>
          <camunda:property name="display_name" value="pc.display_name" />
        </camunda:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0xifvai</bpmn:incoming>
      <bpmn:outgoing>Flow_1imshcg</bpmn:outgoing>
      <bpmn:multiInstanceLoopCharacteristics camunda:collection="pcs" camunda:elementVariable="pc" />
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_1oqem42" name="None" sourceRef="Gateway_0jykh6r" targetRef="Gateway_1oxt6h1">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">len(pcs.keys()) == 0</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:exclusiveGateway id="Gateway_PI_is_DeptChair" name="PI is Dept Chair?" default="Flow_0vi6thu">
      <bpmn:incoming>Flow_0erlzl1</bpmn:incoming>
      <bpmn:incoming>Flow_0srh2hp</bpmn:incoming>
      <bpmn:outgoing>Flow_0vi6thu</bpmn:outgoing>
      <bpmn:outgoing>Flow_00yhlrq</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0vi6thu" name="No" sourceRef="Gateway_PI_is_DeptChair" targetRef="Activity_1sffono" />
    <bpmn:sequenceFlow id="Flow_00yhlrq" name="Yes" sourceRef="Gateway_PI_is_DeptChair" targetRef="Activity_ShowPI_is_DeptChair">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">dc.uid == pi.uid</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:manualTask id="Activity_ShowPI_is_DeptChair" name="Show PI is Dept Chair">
      <bpmn:documentation>The PI is also the Responsible Organization's Chair</bpmn:documentation>
      <bpmn:incoming>Flow_00yhlrq</bpmn:incoming>
      <bpmn:outgoing>Flow_0kpe12r</bpmn:outgoing>
    </bpmn:manualTask>
    <bpmn:sequenceFlow id="Flow_0kpe12r" sourceRef="Activity_ShowPI_is_DeptChair" targetRef="Activity_1rqni31" />
    <bpmn:exclusiveGateway id="Gateway_1oxt6h1" name="How many Sub-Investigators?" default="Flow_05rqrlf">
      <bpmn:incoming>Flow_1oqem42</bpmn:incoming>
      <bpmn:incoming>Flow_1imshcg</bpmn:incoming>
      <bpmn:outgoing>Flow_05rqrlf</bpmn:outgoing>
      <bpmn:outgoing>Flow_0jxzqw1</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_05rqrlf" name="1 or more" sourceRef="Gateway_1oxt6h1" targetRef="Activity_0yd4wuz" />
    <bpmn:sequenceFlow id="Flow_0ofpgml" sourceRef="Activity_0yd4wuz" targetRef="Gateway_13k761k" />
    <bpmn:sequenceFlow id="Flow_0jxzqw1" name="None" sourceRef="Gateway_1oxt6h1" targetRef="Gateway_13k761k">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">len(subs.keys()) == 0</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Activity_0yd4wuz" name="Update Sub-Investigator Info" camunda:formKey="SI_AccessEmails">
      <bpmn:documentation>The following Sub-Investigators were entered in Protocol Builder:
{%+ for key, value in subs.items() %}{{value.display_name}} ({{key}}){% if loop.index is lt cnt_subs %}, {% endif %}{% endfor %}
To Save the current settings for all Sub-Investigators, select Save All.


Otherwise, edit each Sub-Investigator as necessary and select the Save button for each.


### Please provide supplemental information for:
 #### {{ sub.display_name }} 
 ##### Title: {{ sub.title }}

 ##### Department: {{ sub.department }}
 ##### Affiliation: {{ sub.affiliation }}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="sub.access" label="Should this Sub-Investigator have full editing access in the system?" type="boolean" defaultValue="false" />
          <camunda:formField id="sub.emails" label="Should this Sub-Investigator receive automated email notifications?" type="boolean" defaultValue="false" />
        </camunda:formData>
        <camunda:properties>
          <camunda:property name="display_name" value="sub.display_name" />
        </camunda:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_05rqrlf</bpmn:incoming>
      <bpmn:outgoing>Flow_0ofpgml</bpmn:outgoing>
      <bpmn:multiInstanceLoopCharacteristics camunda:collection="subs" camunda:elementVariable="sub" />
    </bpmn:userTask>
    <bpmn:scriptTask id="ScriptTask_Update_PIData" name="Set PI Data">
      <bpmn:incoming>Flow_0tsdclr</bpmn:incoming>
      <bpmn:incoming>Flow_0tfprc8</bpmn:incoming>
      <bpmn:outgoing>Flow_0vu7oqk</bpmn:outgoing>
      <bpmn:script>udsPI_ExperienceKey = "udsPI_ExperienceKey_" + pi.user_id
pi.experience = user_data_get(udsPI_ExperienceKey,"")</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_13k761k" name="How many Additional Personnel? " default="Flow_0q56tn8">
      <bpmn:incoming>Flow_0ofpgml</bpmn:incoming>
      <bpmn:incoming>Flow_0jxzqw1</bpmn:incoming>
      <bpmn:outgoing>Flow_0q56tn8</bpmn:outgoing>
      <bpmn:outgoing>Flow_0kp47dz</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0q56tn8" name="1 or more" sourceRef="Gateway_13k761k" targetRef="Activity_1sra1vn" />
    <bpmn:sequenceFlow id="Flow_0kp47dz" name="None" sourceRef="Gateway_13k761k" targetRef="Activity_SetAssociates">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">len(aps.keys()) == 0</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Activity_1sra1vn" name="Update Additional Personnel Info" camunda:formKey="AP_AccessEmails">
      <bpmn:documentation>The following Additional Personnel were entered in Protocol Builder:
{%+ for key, value in aps.items() %}{{value.display_name}} ({{key}}){% if loop.index is lt cnt_aps %}, {% endif %}{% endfor %}
To Save the current settings for all Additional Personnel, select Save All.




Otherwise, edit each Additional Personnel as necessary and select the Save button for each.




### Please provide supplemental information for:
 #### {{ ap.display_name }} 
 ##### Title: {{ ap.title }}


 ##### Department: {{ ap.department }}
 ##### Affiliation: {{ ap.affiliation }}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="ap.access" label="Should this Additional Personnel have full editing access in the system?" type="boolean" defaultValue="false" />
          <camunda:formField id="ap.emails" label="Should this Additional Personnel receive automated email notifications?" type="boolean" defaultValue="false" />
        </camunda:formData>
        <camunda:properties>
          <camunda:property name="display_name" value="ap.display_name" />
        </camunda:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0q56tn8</bpmn:incoming>
      <bpmn:outgoing>Flow_15f6bwx</bpmn:outgoing>
      <bpmn:multiInstanceLoopCharacteristics camunda:collection="aps" camunda:elementVariable="ap" />
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_CheckUIDs" name="Invalid UIDs?" default="Flow_0tfprc8">
      <bpmn:incoming>Flow_1dcsioh</bpmn:incoming>
      <bpmn:outgoing>Flow_0tfprc8</bpmn:outgoing>
      <bpmn:outgoing>Flow_0nz62mu</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0tfprc8" name="No" sourceRef="Gateway_CheckUIDs" targetRef="ScriptTask_Update_PIData" />
    <bpmn:sequenceFlow id="Flow_0nz62mu" name="Yes" sourceRef="Gateway_CheckUIDs" targetRef="Activity_19z6vct">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">pcs_invalid_uid or subs_invalid_uid or aps_invalid_uid</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Activity_19z6vct" name="Show Invalid UIDs" camunda:formKey="ShowInvalidUIDs">
      <bpmn:documentation>One or more invalid Computing Ids were found.  Select No if all displayed invalid Computing IDs do not need system access and/or receive emails and you would like to proceed without correcting them.  If your would prefer to correct them, correct in Protocol Builder first and then select Yes to check them again.


{% if pcs_invalid_uid %}
**Primary Coordinators**
{% for k, px in pcx.items() %}
{{ px.error }}
{% endfor %}
{% endif %}
{% if subs_invalid_uid %}
**Sub-Investigators**
{% for k, sx in subx.items() %}
{{ sx.error }}
{% endfor %}
{% endif %}
{% if aps_invalid_uid %}
**Additional Personnnel**
{% for k, ax in aps.items() %}
{{ ax.error }}
{% endfor %}
{% endif %}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="FixInvalidUIDs" label="Do you want to fix?" type="boolean">
            <camunda:properties>
              <camunda:property id="description" value="Select Yes if you have corrected in Protocol Builder, No if you would like to proceed without correcting." />
            </camunda:properties>
            <camunda:validation>
              <camunda:constraint name="required" config="True" />
            </camunda:validation>
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0nz62mu</bpmn:incoming>
      <bpmn:outgoing>Flow_16bkbuc</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_FixInvalidUIDs" name="Fix Invalid UIDs?" default="Flow_00zanzw">
      <bpmn:incoming>Flow_16bkbuc</bpmn:incoming>
      <bpmn:outgoing>Flow_00zanzw</bpmn:outgoing>
      <bpmn:outgoing>Flow_0tsdclr</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_16bkbuc" sourceRef="Activity_19z6vct" targetRef="Gateway_FixInvalidUIDs" />
    <bpmn:sequenceFlow id="Flow_00zanzw" name="Yes" sourceRef="Gateway_FixInvalidUIDs" targetRef="ScriptTask_LoadPersonnel" />
    <bpmn:sequenceFlow id="Flow_0tsdclr" name="No" sourceRef="Gateway_FixInvalidUIDs" targetRef="ScriptTask_Update_PIData">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">not(FixInvalidUIDs)</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Activity_1sffono" name="Update Chair Info" camunda:formKey="RO_Chair_Info">
      <bpmn:documentation>***Name:*** {{ dc.display_name }}
***Email:*** {{ dc.email_address }}</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="dc.access" label="Should the Department Chair have full editing access in the system?" type="boolean" defaultValue="false" />
          <camunda:formField id="dc.emails" label="Should the Department Chair receive automated email notifications?" type="boolean" defaultValue="false" />
        </camunda:formData>
        <camunda:properties>
          <camunda:property name="display_name" value="&#34;Responsible Organization&#39;s Chair Info&#34;" />
        </camunda:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0vi6thu</bpmn:incoming>
      <bpmn:outgoing>Flow_1ayisx2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_1ayisx2" sourceRef="Activity_1sffono" targetRef="Activity_1rqni31" />
    <bpmn:scriptTask id="Activity_Update_PI_Experience" name="Update PI Experience">
      <bpmn:incoming>Flow_07ur9cc</bpmn:incoming>
      <bpmn:outgoing>Flow_0srh2hp</bpmn:outgoing>
      <bpmn:script>user_data_set(udsPI_ExperienceKey, pi.experience)</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_0itulqf" name="PI Experience Updated?" default="Flow_0erlzl1">
      <bpmn:incoming>Flow_0lprixw</bpmn:incoming>
      <bpmn:outgoing>Flow_07ur9cc</bpmn:outgoing>
      <bpmn:outgoing>Flow_0erlzl1</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_07ur9cc" name="Yes" sourceRef="Gateway_0itulqf" targetRef="Activity_Update_PI_Experience">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">pi.experience != user_data_get(udsPI_ExperienceKey,"")</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_09rormr" sourceRef="Activity_EditPI" targetRef="Activity_004ix0k" />
    <bpmn:sequenceFlow id="Flow_0vu7oqk" sourceRef="ScriptTask_Update_PIData" targetRef="Activity_EditPI" />
    <bpmn:sequenceFlow id="Flow_0erlzl1" name="No" sourceRef="Gateway_0itulqf" targetRef="Gateway_PI_is_DeptChair" />
    <bpmn:sequenceFlow id="Flow_0srh2hp" sourceRef="Activity_Update_PI_Experience" targetRef="Gateway_PI_is_DeptChair" />
    <bpmn:sequenceFlow id="Flow_1imshcg" sourceRef="TaskPMI_UpdateCoordinatorInfo" targetRef="Gateway_1oxt6h1" />
    <bpmn:scriptTask id="Activity_SetAssociates" name="Set Associates">
      <bpmn:incoming>Flow_0kp47dz</bpmn:incoming>
      <bpmn:incoming>Flow_15f6bwx</bpmn:incoming>
      <bpmn:outgoing>Flow_1ounwjs</bpmn:outgoing>
      <bpmn:script># Add Additional Personnel
if cnt_aps != 0:
	for k in aps.keys():
		ap = aps.get(k)
		update_study_associate(uid=ap.uid,access=ap.access,send_email=ap.emails,role=ap.label)
# Add Sub-Investigators
if cnt_subs != 0:
	for k in subs.keys():
		sub = subs.get(k)
		update_study_associate(uid=sub.uid,access=sub.access,send_email=sub.emails,role=sub.label)

# Add Primary Coordinators
if cnt_pcs != 0:
	for k in pcs.keys():
		pc = pcs.get(k)
		update_study_associate(uid=pc.uid,access=pc.access,send_email=pc.emails,role=pc.label)
# Add Department Chair
update_study_associate(uid=dc.uid,access=dc.access,send_email=dc.emails,role=dc.label)
# Add Principle Investigator
update_study_associate(uid=pi.uid,access=pi.access,send_email=pi.emails,role=pi.label)</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_15f6bwx" sourceRef="Activity_1sra1vn" targetRef="Activity_SetAssociates" />
    <bpmn:sequenceFlow id="Flow_1ounwjs" sourceRef="Activity_SetAssociates" targetRef="EndEvent_1qor16n" />
    <bpmn:sequenceFlow id="Flow_0lprixw" sourceRef="Activity_004ix0k" targetRef="Gateway_0itulqf" />
    <bpmn:scriptTask id="Activity_004ix0k" name="Set PI Datastore">
      <bpmn:incoming>Flow_09rormr</bpmn:incoming>
      <bpmn:outgoing>Flow_0lprixw</bpmn:outgoing>
      <bpmn:script>study_data_set("sdsPI_ComputingID",pi.uid)</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_1h7zs6c" sourceRef="Activity_1rqni31" targetRef="Gateway_0jykh6r" />
    <bpmn:scriptTask id="Activity_1rqni31" name="Set Dept Chair Datastore">
      <bpmn:incoming>Flow_1ayisx2</bpmn:incoming>
      <bpmn:incoming>Flow_0kpe12r</bpmn:incoming>
      <bpmn:outgoing>Flow_1h7zs6c</bpmn:outgoing>
      <bpmn:script>study_data_set("sdsDC_ComputingID",dc.uid)</bpmn:script>
    </bpmn:scriptTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="UserTask_ShowInvalidUIDs">
      <bpmndi:BPMNEdge id="Flow_1ounwjs_di" bpmnElement="Flow_1ounwjs">
        <di:waypoint x="3960" y="290" />
        <di:waypoint x="4052" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_15f6bwx_di" bpmnElement="Flow_15f6bwx">
        <di:waypoint x="3790" y="290" />
        <di:waypoint x="3860" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1imshcg_di" bpmnElement="Flow_1imshcg">
        <di:waypoint x="3150" y="290" />
        <di:waypoint x="3225" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0srh2hp_di" bpmnElement="Flow_0srh2hp">
        <di:waypoint x="2320" y="420" />
        <di:waypoint x="2430" y="420" />
        <di:waypoint x="2430" y="315" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0erlzl1_di" bpmnElement="Flow_0erlzl1">
        <di:waypoint x="2295" y="290" />
        <di:waypoint x="2405" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2341" y="272" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vu7oqk_di" bpmnElement="Flow_0vu7oqk">
        <di:waypoint x="1790" y="290" />
        <di:waypoint x="1870" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_09rormr_di" bpmnElement="Flow_09rormr">
        <di:waypoint x="1970" y="290" />
        <di:waypoint x="2070" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_07ur9cc_di" bpmnElement="Flow_07ur9cc">
        <di:waypoint x="2270" y="315" />
        <di:waypoint x="2270" y="380" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2276" y="345" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ayisx2_di" bpmnElement="Flow_1ayisx2">
        <di:waypoint x="2660" y="290" />
        <di:waypoint x="2750" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0tsdclr_di" bpmnElement="Flow_0tsdclr">
        <di:waypoint x="1595" y="530" />
        <di:waypoint x="1740" y="530" />
        <di:waypoint x="1740" y="330" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1590" y="512" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_00zanzw_di" bpmnElement="Flow_00zanzw">
        <di:waypoint x="1570" y="555" />
        <di:waypoint x="1570" y="600" />
        <di:waypoint x="1400" y="600" />
        <di:waypoint x="1400" y="330" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1464" y="582" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_16bkbuc_di" bpmnElement="Flow_16bkbuc">
        <di:waypoint x="1570" y="450" />
        <di:waypoint x="1570" y="505" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0nz62mu_di" bpmnElement="Flow_0nz62mu">
        <di:waypoint x="1570" y="315" />
        <di:waypoint x="1570" y="370" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1576" y="339" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0tfprc8_di" bpmnElement="Flow_0tfprc8">
        <di:waypoint x="1595" y="290" />
        <di:waypoint x="1690" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1613" y="272" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kp47dz_di" bpmnElement="Flow_0kp47dz">
        <di:waypoint x="3560" y="315" />
        <di:waypoint x="3560" y="400" />
        <di:waypoint x="3910" y="400" />
        <di:waypoint x="3910" y="330" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3722" y="382" width="27" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0q56tn8_di" bpmnElement="Flow_0q56tn8">
        <di:waypoint x="3585" y="290" />
        <di:waypoint x="3690" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3614" y="272" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0jxzqw1_di" bpmnElement="Flow_0jxzqw1">
        <di:waypoint x="3250" y="265" />
        <di:waypoint x="3250" y="200" />
        <di:waypoint x="3560" y="200" />
        <di:waypoint x="3560" y="265" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3392" y="182" width="27" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ofpgml_di" bpmnElement="Flow_0ofpgml">
        <di:waypoint x="3470" y="290" />
        <di:waypoint x="3535" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_05rqrlf_di" bpmnElement="Flow_05rqrlf">
        <di:waypoint x="3275" y="290" />
        <di:waypoint x="3370" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3299" y="272" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kpe12r_di" bpmnElement="Flow_0kpe12r">
        <di:waypoint x="2660" y="120" />
        <di:waypoint x="2800" y="120" />
        <di:waypoint x="2800" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_00yhlrq_di" bpmnElement="Flow_00yhlrq">
        <di:waypoint x="2430" y="265" />
        <di:waypoint x="2430" y="120" />
        <di:waypoint x="2560" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2441" y="223" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vi6thu_di" bpmnElement="Flow_0vi6thu">
        <di:waypoint x="2455" y="290" />
        <di:waypoint x="2560" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2468" y="272" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1oqem42_di" bpmnElement="Flow_1oqem42">
        <di:waypoint x="2920" y="315" />
        <di:waypoint x="2920" y="400" />
        <di:waypoint x="3250" y="400" />
        <di:waypoint x="3250" y="315" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3076" y="382" width="27" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0xifvai_di" bpmnElement="Flow_0xifvai">
        <di:waypoint x="2945" y="290" />
        <di:waypoint x="3050" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2968" y="273" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1dcsioh_di" bpmnElement="Flow_1dcsioh">
        <di:waypoint x="1450" y="290" />
        <di:waypoint x="1545" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kcrx5l_di" bpmnElement="Flow_0kcrx5l">
        <di:waypoint x="1278" y="290" />
        <di:waypoint x="1350" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0lprixw_di" bpmnElement="Flow_0lprixw">
        <di:waypoint x="2170" y="290" />
        <di:waypoint x="2245" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1h7zs6c_di" bpmnElement="Flow_1h7zs6c">
        <di:waypoint x="2850" y="290" />
        <di:waypoint x="2895" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="1242" y="272" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_0h49cmf_di" bpmnElement="ScriptTask_LoadPersonnel">
        <dc:Bounds x="1350" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0d622qi_di" bpmnElement="Activity_EditPI">
        <dc:Bounds x="1870" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_02led02_di" bpmnElement="ScriptTask_Update_PIData">
        <dc:Bounds x="1690" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1gq2m4q_di" bpmnElement="Gateway_CheckUIDs" isMarkerVisible="true">
        <dc:Bounds x="1545" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1537" y="241" width="66" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1l5u9mj_di" bpmnElement="Activity_19z6vct">
        <dc:Bounds x="1520" y="370" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_01e55pl_di" bpmnElement="Gateway_FixInvalidUIDs" isMarkerVisible="true">
        <dc:Bounds x="1545" y="505" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1468" y="503" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1xio5hy_di" bpmnElement="Gateway_PI_is_DeptChair" isMarkerVisible="true">
        <dc:Bounds x="2405" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2448" y="322" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0ou9hjq_di" bpmnElement="Activity_Update_PI_Experience">
        <dc:Bounds x="2220" y="380" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0itulqf_di" bpmnElement="Gateway_0itulqf" isMarkerVisible="true">
        <dc:Bounds x="2245" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2236" y="235" width="69" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0jkeu8f_di" bpmnElement="Activity_004ix0k">
        <dc:Bounds x="2070" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1qor16n_di" bpmnElement="EndEvent_1qor16n">
        <dc:Bounds x="4052" y="272" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="4300" y="283" width="20" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0jykh6r_di" bpmnElement="Gateway_0jykh6r" isMarkerVisible="true">
        <dc:Bounds x="2895" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2925" y="309" width="70" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1nz85vv_di" bpmnElement="TaskPMI_UpdateCoordinatorInfo">
        <dc:Bounds x="3050" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1oxt6h1_di" bpmnElement="Gateway_1oxt6h1" isMarkerVisible="true">
        <dc:Bounds x="3225" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3270" y="315" width="79" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0oyqfs3_di" bpmnElement="Activity_0yd4wuz">
        <dc:Bounds x="3370" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_13k761k_di" bpmnElement="Gateway_13k761k" isMarkerVisible="true">
        <dc:Bounds x="3535" y="265" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3582" y="309" width="56" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1m6r78y_di" bpmnElement="Activity_1sra1vn">
        <dc:Bounds x="3690" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_00ky9r8_di" bpmnElement="Activity_SetAssociates">
        <dc:Bounds x="3860" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1hb7zyh_di" bpmnElement="Activity_1rqni31">
        <dc:Bounds x="2750" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0i869dj_di" bpmnElement="Activity_ShowPI_is_DeptChair">
        <dc:Bounds x="2560" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1sffono_di" bpmnElement="Activity_1sffono">
        <dc:Bounds x="2560" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
